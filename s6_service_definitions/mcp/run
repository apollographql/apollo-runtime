#!/command/with-contenv bash

# Set our working directory
cd /opt || exit

ARGS=(--endpoint http://127.0.0.1:4000 --sse-address 0.0.0.0 --sse-port 5001 --operations /config/operations --introspection)

if [[ -z "$APOLLO_GRAPH_REF" || -z "$APOLLO_KEY" ]]; then
  ARGS+=(--schema /config/api_schema.graphql)
else
  ARGS+=(--uplink)
fi

exec /opt/apollo-mcp-server "${ARGS[@]}"

